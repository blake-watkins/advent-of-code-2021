(in-package :aoc-2021)

;; Parse the hex characters. The format string converts each digit into four
;; binary digits with leading zeroes and concatenates them all into a big string.
(defun parse-file ()
  (with-monad
    (assign values (parse-list (parse-digit :base 16) ""))
    (unit (format nil "船О漫鲠祯弩┅┅ㄤ彐躅疳蝮瀛忾ī疳蝮瀛溟玳衡狍博ㄤ彐躅疳蝮瀛铛礅弪骈屐戾铉翳鏖翳盹钺ㄡ篌殓忾趔瞽镦戾铉翳疳蝮瀛忾舂┅躅轸ㄤ殓轸蟓麸轭忾趔衡狍博┅ㄤ彐躅疳蝮瀛铛礅弪溽翎é镳糸镱犰ㄡ沣癌鏖翳盹钺ㄡ篌殓盹蝈忾趔疳蝮瀛忾舂ㄡ篌殓溽翎忾趔瞽镦疳蝮瀛忾舂┅戾è铄鳝徙ǐí徙倍ㄤ殓轸蟓麸轭溽翎忾趔┅┅ㄩ盹蝈忾趔皓躅轸铄鳝徙悌疳蝮瀛铛礅弪溽翎铄鳝徙悌┅┅ㄤ彐躅疳蝮瀛镳弪狒矧溽翎ī鏖翳盹钺ㄡ篌殓戾铉翳豉疱殇疳蝮瀛忾舂ㄩ戾铉翳豉疱殇癌鏖翳盹钺ㄡ篌殓戾铉翳疳蝮瀛铛礅弪骈屐钡┅疳蝮瀛篚怵狎箦戾铉翳疳蝮瀛疳汶弭螬┅鏖翳盹钺ㄡ篌殓戾铉翳疳蝮瀛铛礅弪骈屐北┅瞽镦戾铉翳疳蝮瀛疳汶弭┅┅┅ㄤ彐躅疳蝮瀛疳汶弭ī疳蝮瀛扉篝疳蝮瀛疳汶弭┅ㄤ彐躅疳蝮瀛疳汶弭ī鏖翳盹钺ㄡ篌殓鲥蝮轱疳蝮瀛铛礅弪骈屐畅ㄡ篌殓豉疱殇疳蝮瀛铛礅弪骈屐畅ㄡ篌殓溽翎ㄩ豉疱殇穿疳蝮瀛铛礅弪溽翎疳蝮瀛镳弪狒矧溽翎┅躅轸扉篝鲥蝮轱磲瓠镳弪狒矧豉疱殇溽翎┅┅ㄤ彐躅磲瓠镳弪狒矧镳ㄡ蝈（黹磲侯蹴僵镳┅ㄤ彐躅徜洵鲥蝮轱铙疳汶弭ㄤ弩趄蹉趱蜷铉忾钿鲥蝮轱镳泔溴溽翎疳汶弭ㄩㄥ侯蹴镳泔溴鲥蝮轱ǐ鲥蝮轱蝈漉沐＇磲疸狎＇徜洵鲥蝮轱铙溽翎┅┅┅ㄤ彐躅弼犰疳汶弭疳汶弭ㄤ弩趄蹉趱蜷铉忾钿鲥蝮轱镳泔溴溽翎疳汶弭ㄤ邈灬蝈ㄩ珙矧鲥蝮轱瞟ㄩㄥ侯蹴镳泔溴溽翎戾è蝈蝈漉沐镳泔溴磲疸狎＇疳汶弭箦溽翎┅┅ㄩㄦ轭镳泔溴Ж僵ㄩ蝈癌蝈舂┅┅ㄤ彐躅溽倍ㄩ铕豸脲疳螋博戾舄è忾舡篝蜷铉蝓瞽疳蝮弪疳蝮瀛骈戾轭瘐舂疳汶弭蝓瞽疳蝮弪疳蝮瀛疳汶弭忾舡篝蜷铉┅ㄩ疳螋暴ㄡ滗鲥蝮轱铙疳汶弭ㄥ鲠飙疳汶弭疳汶弭┅┅